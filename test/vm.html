<!DOCTYPE html>
<html lang="ko">
<head>
<title>bs6-bs</title>
<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="format-detection" content="telephone=no"/>
<meta name="apple-mobile-web-app-capable" content="yes"/>
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/>
<meta name="mobile-web-app-capable" content="yes">
<meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1,minimum-scale=1"/>
<style>
body{margin:0;padding:0;font-family:"D2Coding", Arial, "monospace"}
#doc{margin:10px}
</style>
</head>
<body data-bs="{'@a':3}">
  <div id="t0" data-bs="{'@a':3, html:'t0'}"></div>
  <div id="t1" data-bs="{k:'k0'}">
    <div id="t1_0" data-bs="{'@a':3, 'html':'t1_0'}"></div>
    <div id="t1_1" data-bs="{'@a':'@{t1_1}', 'html':'@{t1_1}'}"></div>
  </div>
  <div id="t2" data-bs="{'@a':'@{t2}', 'html':'@{t2}'}"></div>
  <div data-tmpl="{k:'c,d', role:'body', nth:'+i % 3 == 2'}"></div>
  <nav data-tmpl="{k:'e', role:'header'}"></nav>
  <nav data-tmpl="{k:'e', role:'header'}"></nav>
  <div data-tmpl="{k:'e'}"></div>
  <p data-tmpl="{k:'e'}"></p>
  <footer data-tmpl="{k:'e', role:'footer'}"></footer>
  <footer data-tmpl="{k:'e', role:'footer'}"></footer>
  <p data-tmpl="{k:'e', role:'empty'}"></p>
  <p data-tmpl="{k:'e', role:'empty'}"></p>
  
  
  <section id="v0" data-bs="{k:'v0', d:'vm0', a:[1,2,3], t:'t0'}">
    <div data-tmpl="{k:'t0'}" data-bs="{'@a':'.{title}'}">
      <p data-bs="{html:'.{item}'}"></p>
    </div>
  </section>
  <section id="v1" data-bs="{k:'v1', d:'vm1', t:'t1'}">
    <p data-tmpl="{k:'t1', nth:'+i%2'}" style="background:#fee" data-bs="{'html':'.{title}'}"></p>
    <div data-tmpl="{k:'t1', nth:'+i%2 == 0'}" style="background:#ffe" data-bs="{'html':'.{title}'}"></div>
    <section data-tmpl="{k:'t1_1'}" style="background:#f66;color:#fff" data-bs="{'html':'.{title}'}"></section>
  </section>
  <section id="v2" data-bs="{k:'v2', d:'vm2', t:'t2'}">
    <nav data-tmpl="{k:'t2', role:'header'}" style="background:#fee" data-bs="{'html':'header'}"></nav>
    <p data-tmpl="{k:'t2', nth:'+i%2'}" style="background:#fef" data-bs="{'html':'.{title}'}"></p>
    <div data-tmpl="{k:'t2', nth:'+i%2 == 0'}" style="background:#efe" data-bs="{'html':'.{title}'}"></div>
    <footer data-tmpl="{k:'t2', role:'footer'}" style="background:#ffe" data-bs="{'html':'footer'}"></footer>
  </section>
  <section id="v3" data-bs="{k:'v3', d:'vm3', t:'t3'}">
    <div data-tmpl="{k:'t3', d:'v3t30'}" style="background:#ffe" data-bs="{'html':'.{title}'}"></div>
  </section>
  <ul id="v4" data-bs="{k:'v4', d:'vm4', t:'t4'}">
    <li data-tmpl="k:'t4'">
      <div data-bs="html:'.{title}'"></div>
      <ul data-bs="d:'vm4_1', t:'t4'"></ul>
    </li>
  </ul>
  <ul data-bs="data:'t0data', tmpl:'t0data'">
    <li data-tmpl="t0data" data-bs="data:'.{sub}', tmpl:'t1data'">
      <div data-tmpl="t1data" data-bs="html:'#{.{PARENT.title} + ` > ` + .{title}}'"></div>
    </li>
  </ul>
<table data-bs="d:'t2data', t:'t2data'">
  <tr data-tmpl="t2data" data-bs="d:'.{td}', t:'t3data'">
    <td data-tmpl="t3data" data-bs="html:'#{.{INFO}[.{IDX}] + ` : ` + .{v}}'"></td>
  </tr>
</table>
<ul data-bs="d:'t4data', t:'t4data'">
  <li data-tmpl="t4data" data-bs="html:'#{(.{IDX} + 1)+`/`+.{CNT} + ` - ` + .{title}}'"></li>
</ul>
  
<script src="//www.bsidesoft.com/api/js/6/build/test.php"></script>
<script src="//www.bsidesoft.com/api/js/test/2/index.js"></script>
<script>
bs.scan();
(function(){
  var info = {INFO:1, '0':'id', '1':'nick', '2':'email'};
  bs('t2data', [
    {td:[info, {v:'433'}, {v:'hika'}, {v:'hika@bsidesoft.com'}]},
    {td:[info, {v:'765'}, {v:'summer'}, {v:'summer@bsidesoft.com'}]}
  ]);
})();
bs('t4data', [{title:'apple'}, {title:'banana'}, {title:'orange'}]);
bs(
't0data', [
  {title:'item1', sub:[{title:'sub1'}, {title:'sub2'}, {title:'sub3'}]},
  {title:'item2', sub:[{title:'sub1'}, {title:'sub2'}, {title:'sub3'}]}
]
);
bs('vm4', function(){return [
  {title:'menu1', sub:[
    {title:'1-1', sub:[]},
    {title:'1-2', sub:[
      {title:'1-2-1', sub:[]},
      {title:'1-2-2', sub:[]}
    ]}
  ]},
  {title:'menu2', sub:[
    {title:'2-1', sub:[]},
    {title:'2-2', sub:[
      {title:'2-2-1', sub:[]},
      {title:'2-2-2', sub:[]}
    ]}
  ]}
];}, 'vm4_1', function(){return bs('.{sub}');});
  
  
bsTest.run('vm', null,
function(flow){
	flow.ok("body 속성반영");
	return document.body.getAttribute('a');
}, '3',
function(flow){
	flow.ok("child 속성반영");
	return document.getElementById('t0').getAttribute('a') + ":" + document.getElementById('t1_0').getAttribute('a');
}, '3:3',
function(flow){
	flow.ok("vm등록");
	return bs.vm('k0').k + ":" + bs.vm('k0').vms.len + ":" + bs.vm('v0').k + ":" + bs.vm('v0').vms.len;
}, 'k0:2:v0:0',
function(flow){
	flow.ok("@{}렌더");
  bs('t1_1', 1, 't2', 3);
  bs.render();
	return document.getElementById('t1_1').getAttribute('a') + ":" + document.getElementById('t2').getAttribute('a');
}, '1:3',
function(flow){
	flow.ok("서브렌더");
  bs('t1_1', 2, 't2', 5);
  bs.render('k0');
	return document.getElementById('t1_1').getAttribute('a') + ":" + document.getElementById('t2').getAttribute('a');
}, '2:3',
function(flow){
  flow.ok("tmpl 수동등록");
  bs.tmpl('<div></div>', 'a,b', 'body', '+i % 3 == 2');
  var a = bs.TMPL('a').body, b = bs.TMPL('b').body;
  return a.len +":" + b.len + ":" + a[0].nth.p.length +":" + a[0].nth.p[0](2, 0);
}, "1:1:1:true",
function(flow){
  flow.ok("tmpl 자동등록");
  var a = bs.TMPL('c').body, b = bs.TMPL('d').body;
  return a.len +":" + b.len + ":" + a[0].nth.p.length +":" + a[0].nth.p[0](2, 0);
}, "1:1:1:true",
function(flow){
  flow.ok("tmpl 다수등록1");
  var e = bs.TMPL('e');
  return e.header.len +":" + e.footer.len + ":" + e.body.len +":" + e.empty.len;
}, "2:2:2:2",
function(flow){
  flow.ok("tmpl 다수등록2");
  var e = bs.TMPL('e');
  return e.header[0].el.tagName +":" + e.header[1].el.tagName + ":" + 
    e.body[0].el.tagName +":" + e.body[1].el.tagName + ":" + 
    e.footer[0].el.tagName +":" + e.footer[1].el.tagName + ":" + 
    e.empty[0].el.tagName +":" + e.empty[1].el.tagName;
}, "NAV:NAV:DIV:P:FOOTER:FOOTER:P:P",
function(flow){
  flow.ok("tmpl render1");
  var val;
  bs('vm0', function(a,b,c){
    val = a + b + c;
    return [{title:'a', item:'p1'}, {title:'b', item:'p2'}];
  });
  bs.render('v0');
  var v0 = document.getElementById('v0');
  var a = v0.firstElementChild, b = a.nextElementSibling;
  return [val, a.tagName, b.tagName, a.getAttribute('a'), b.getAttribute('a'),
    a.firstElementChild.innerHTML, b.firstElementChild.innerHTML
  ].join(':');
}, '6:DIV:DIV:a:b:p1:p2',
function(flow){
  flow.ok("tmpl render2");
  var val;
  bs('vm0', function(a,b,c){
    val = a + b + c;
    return [{title:'c', item:'p3'}, {title:'d', item:'p4'}];
  });
  bs.render('v0');
  var v0 = document.getElementById('v0');
  var a = v0.firstElementChild, b = a.nextElementSibling;
  return [val, a.tagName, b.tagName, a.getAttribute('a'), b.getAttribute('a'),
    a.firstElementChild.innerHTML, b.firstElementChild.innerHTML
  ].join(':');
}, '6:DIV:DIV:c:d:p3:p4',
function(flow){
  flow.ok("tmpl nth 1");
  bs('vm1', function(){
    return [{title:'aa'}, {title:'bb'}];
  });
  bs.render('v1');
  var v0 = document.getElementById('v1');
  var a = v0.firstElementChild, b = a.nextElementSibling;
  return [a.tagName, b.tagName, a.innerHTML, b.innerHTML
  ].join(':');
}, 'DIV:P:aa:bb',
function(flow){
  flow.ok("tmpl nth 2");
  bs('vm1', function(){
    return [{title:'cc'}, {title:'dd'}, {title:'ee'}, {title:'ff'}];
  });
  bs.render('v1');
  var v0 = document.getElementById('v1');
  var a = v0.firstElementChild, b = a.nextElementSibling, c = b.nextElementSibling, d = c.nextElementSibling;
  return [a.tagName, b.tagName, c.tagName, d.tagName, a.innerHTML, b.innerHTML, c.innerHTML, d.innerHTML
  ].join(':');
}, 'DIV:P:DIV:P:cc:dd:ee:ff',
function(flow){
  flow.ok("tmpl nth 3");
  bs('vm1', function(){
    return [{title:'gg'}, {title:'hh'}];
  });
  bs.render('v1');
  var v0 = document.getElementById('v1');
  var a = v0.firstElementChild, b = a.nextElementSibling;
  return [a.tagName, b.tagName, a.innerHTML, b.innerHTML
  ].join(':');
}, 'DIV:P:gg:hh',
function(flow){
  flow.ok("tmpl nth 4");
  bs('vm1', function(){
    return [{title:'cc'}, {title:'dd'}, {title:'ee'}, {title:'ff'}];
  });
  bs.render('v1');
  var v0 = document.getElementById('v1');
  var a = v0.firstElementChild, b = a.nextElementSibling, c = b.nextElementSibling, d = c.nextElementSibling;
  return [a.tagName, b.tagName, c.tagName, d.tagName, a.innerHTML, b.innerHTML, c.innerHTML, d.innerHTML
  ].join(':');
}, 'DIV:P:DIV:P:cc:dd:ee:ff',
function(flow){
  flow.ok("tmpl nth 5");
  bs('vm1', function(){
    return [{'@tmpl':'t1_1', title:'cc'}, {title:'dd'}, {'@tmpl':'t1_1', title:'ee'}, {title:'ff'}];
  });
  bs.render('v1');
  var v0 = document.getElementById('v1');
  var a = v0.firstElementChild, b = a.nextElementSibling, c = b.nextElementSibling, d = c.nextElementSibling;
  return [a.tagName, b.tagName, c.tagName, d.tagName, a.innerHTML, b.innerHTML, c.innerHTML, d.innerHTML
  ].join(':');
}, 'SECTION:P:SECTION:P:cc:dd:ee:ff',
function(flow){
  flow.ok("tmpl record vm");
  bs('vm3', function(){
    return [{title:'cc'}, {title:'dd'}, {title:'ee'}, {title:'ff'}];
  },
  'v3t30', function(vm){
    return {title:vm.title + '*'};
  });
  bs.render('v3');
  var v0 = document.getElementById('v3');
  var a = v0.firstElementChild, b = a.nextElementSibling, c = b.nextElementSibling, d = c.nextElementSibling;
  return [a.tagName, b.tagName, c.tagName, d.tagName, a.innerHTML, b.innerHTML, c.innerHTML, d.innerHTML
  ].join(':');
}, 'DIV:DIV:DIV:DIV:cc*:dd*:ee*:ff*',
function(flow){
  flow.ok("tmpl header footer");
  bs('vm2', function(){
    return [{title:'aa'}, {title:'bb'}, {title:'cc'}, {title:'dd'}];
  });
  bs.render('v2');
  var v0 = document.getElementById('v2');
  var a = v0.bsHeaderBegin.nextElementSibling, b = v0.bsFooterBegin.nextElementSibling;
  var b0 = v0.bsBodyBegin.nextElementSibling;
  var b1 = b0.nextElementSibling, b2 = b1.nextElementSibling, b3 = b2.nextElementSibling;
  return [a.tagName, b.tagName, a.innerHTML, b.innerHTML,
          b0.tagName, b1.tagName, b2.tagName, b3.tagName,
          b0.innerHTML, b1.innerHTML, b2.innerHTML, b3.innerHTML
  ].join(':');
}, 'NAV:FOOTER:header:footer:DIV:P:DIV:P:aa:bb:cc:dd'
);
</script>
</body>
</html>